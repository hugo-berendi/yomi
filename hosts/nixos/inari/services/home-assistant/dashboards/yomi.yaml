title: Yomi Dashboard
views:
  - title: Home
    path: home
    icon: mdi:home
    type: sections
    sections:
      - type: grid
        cards:
          - type: custom:mushroom-person-card
            entity: person.hugo_berendi
            icon_type: entity-picture
            secondary_info: state
          - type: custom:mushroom-chips-card
            chips:
              - type: weather
                entity: weather.forecast_home
                show_conditions: true
                show_temperature: true
              - type: template
                icon: mdi:car-electric
                content: "{{ states('sensor.id_3_battery_level') }}%"
                tap_action:
                  action: navigate
                  navigation_path: /lovelace-yomi/car
              - type: template
                icon: mdi:school
                content: "{{ states('sensor.school_day_status') }}"
                tap_action:
                  action: navigate
                  navigation_path: /lovelace-yomi/school
      - type: grid
        cards:
          - type: weather-forecast
            entity: weather.forecast_home
            show_forecast: true
            forecast_type: daily
            name: Weather
          - type: entities
            title: Quick Status
            show_header_toggle: false
            entities:
              - entity: sensor.webuntis_my_wake_time
                name: My Wake Time
              - entity: sensor.webuntis_my_next_lesson
                name: My Next Lesson
              - entity: sensor.id_3_battery_level
                name: Car Battery
              - entity: sensor.id_3_electric_range
                name: Car Range
              - entity: binary_sensor.id_3_charging_cable_connected
                name: Car Plugged In
      - type: grid
        cards:
          - type: entities
            title: Lights
            show_header_toggle: true
            entities:
              - entity: light.schlafzimmer_1
                name: Bedroom 1
              - entity: light.schlafzimmer_2
                name: Bedroom 2
              - entity: switch.scenic_dreamview1_power_switch
                name: Dreamview
          - type: entities
            title: Sun & Time
            show_header_toggle: false
            entities:
              - entity: sensor.sun_next_rising
                name: Sunrise
              - entity: sensor.sun_next_setting
                name: Sunset

  - title: Car
    path: car
    icon: mdi:car-electric
    type: sections
    sections:
      - type: grid
        cards:
          - type: gauge
            entity: sensor.id_3_battery_level
            name: Battery
            min: 0
            max: 100
            severity:
              green: 50
              yellow: 20
              red: 10
            needle: true
          - type: entities
            title: Status
            show_header_toggle: false
            entities:
              - entity: sensor.id_3_electric_range
                name: Range
              - entity: sensor.id_3_charging_state
                name: Charging
              - entity: sensor.id_3_charging_power
                name: Power
              - entity: sensor.id_3_charging_time_left
                name: Time Left
              - entity: binary_sensor.id_3_charging_cable_connected
                name: Plugged In
      - type: grid
        cards:
          - type: thermostat
            entity: climate.id_3_electric_climatisation
            name: Climate
          - type: entities
            title: Climate Controls
            show_header_toggle: false
            entities:
              - entity: switch.id_3_window_heater
                name: Window Heater
              - entity: sensor.id_3_climatisation_state
                name: Status
      - type: grid
        cards:
          - type: entities
            title: Charging Controls
            show_header_toggle: false
            entities:
              - entity: switch.id_3_charging
                name: Charging
              - entity: number.id_3_battery_target_charge_level
                name: Target Level
              - entity: switch.id_3_battery_care_mode
                name: Battery Care
              - entity: switch.id_3_reduced_ac_charging
                name: Reduced AC
          - type: entities
            title: Security
            show_header_toggle: false
            entities:
              - entity: lock.id_3_door_locked
                name: Doors
              - entity: lock.id_3_trunk_locked
                name: Trunk
              - entity: binary_sensor.id_3_doors_locked
                name: All Locked
              - entity: binary_sensor.id_3_windows_closed
                name: Windows Closed
      - type: grid
        cards:
          - type: map
            entities:
              - device_tracker.id_3_position
            hours_to_show: 24
            default_zoom: 14

  - title: School
    path: school
    icon: mdi:school
    type: sections
    sections:
      - type: grid
        cards:
          - type: entities
            title: My Schedule (Filtered)
            show_header_toggle: false
            entities:
              - entity: sensor.webuntis_my_wake_time
                name: Wake Time
              - entity: sensor.webuntis_my_prep_time
                name: Leave Time
              - entity: sensor.webuntis_my_next_lesson
                name: Next Lesson
              - entity: sensor.webuntis_my_lessons_today
                name: Lessons Today
              - entity: sensor.school_day_status
                name: Status
          - type: markdown
            title: My Lessons Today
            content: >
              {{ state_attr('sensor.webuntis_my_lessons_today', 'schedule') | default('No lessons today') }}
      - type: grid
        cards:
          - type: entities
            title: All Classes (Unfiltered)
            show_header_toggle: false
            entities:
              - entity: sensor.webuntis_today_s_school_start
                name: Class Start
              - entity: sensor.webuntis_today_s_school_end
                name: Class End
              - entity: sensor.webuntis_next_lesson
                name: Next Class
              - entity: sensor.webuntis_wake_time
                name: Class Wake Time
          - type: markdown
            title: Full Schedule
            content: >
              {% set json = state_attr('sensor.webuntis_next_lesson_to_wake_up', 'day') %}
              {% if json and json is string and json.startswith('[') %}
                {% set lessons = json | from_json %}
                {% for lesson in lessons %}
              **{{ lesson.start | as_datetime | as_local | as_timestamp | timestamp_custom('%H:%M') }}** {{ lesson.subjects[0].long_name if lesson.subjects else 'Free' }}{% if lesson.rooms %} ({{ lesson.rooms[0].name }}){% endif %}{% if lesson.teachers %} - {{ lesson.teachers[0].name }}{% endif %}

                {% endfor %}
              {% elif json and 'disabled' in (json | lower) %}
              *Enable JSON in WebUntis settings*
              {% else %}
              No lessons scheduled
              {% endif %}
      - type: grid
        cards:
          - type: calendar
            title: Timetable
            entities:
              - calendar.webuntis
            initial_view: listWeek
          - type: entity
            entity: event.webuntis_lesson_change
            name: Last Change
      - type: grid
        cards:
          - type: entities
            title: My Automations (Filtered)
            show_header_toggle: false
            entities:
              - entity: automation.webuntis_filtered_wake_up
                name: Filtered Wake-Up
              - entity: automation.webuntis_filtered_leave_reminder
                name: Filtered Leave Reminder
              - entity: automation.webuntis_filtered_lesson_change
                name: Filtered Change Alerts
          - type: entities
            title: All-Class Automations
            show_header_toggle: false
            entities:
              - entity: automation.webuntis_dynamic_wake_up
                name: Dynamic Wake-Up
              - entity: automation.webuntis_leave_reminder
                name: Leave Reminder
              - entity: automation.webuntis_lesson_change_notification
                name: Change Alerts
              - entity: automation.fallback_wake_up_07_00
                name: Fallback (07:00)
      - type: grid
        cards:
          - type: markdown
            title: My Teachers
            content: >
              **Always:** SP, KT, MM, KO, FR, BU, WA, TO

              **Conditional:**
              - LO (Math only)
              - MÃœ (WR only)
              - WJ (PuG only)

  - title: Lights
    path: lights
    icon: mdi:lightbulb-group
    type: sections
    sections:
      - type: grid
        cards:
          - type: light
            entity: light.schlafzimmer_1
            name: Bedroom 1
          - type: light
            entity: light.schlafzimmer_2
            name: Bedroom 2
      - type: grid
        cards:
          - type: entities
            title: All Lights
            show_header_toggle: true
            entities:
              - entity: light.schlafzimmer_1
                name: Bedroom 1
              - entity: light.schlafzimmer_2
                name: Bedroom 2
              - entity: switch.scenic_dreamview1_power_switch
                name: Dreamview
              - entity: sensor.scenic_dreamview1_status
                name: Dreamview Status
          - type: entities
            title: Automations
            show_header_toggle: false
            entities:
              - entity: automation.sunset_lighting
                name: Sunset
              - entity: automation.bedtime_lights_off
                name: Bedtime
              - entity: automation.lights_off_when_away
                name: Away
              - entity: automation.welcome_home_lighting
                name: Welcome Home
              - entity: automation.cloudy_morning_lights
                name: Cloudy Morning
              - entity: automation.weather_based_light_adjustment
                name: Weather Adjust

  - title: System
    path: system
    icon: mdi:cog
    type: sections
    sections:
      - type: grid
        cards:
          - type: entities
            title: Phone (Hotei)
            show_header_toggle: false
            entities:
              - entity: device_tracker.hotei
                name: Location
              - entity: sensor.hotei_battery_level
                name: Battery
              - entity: sensor.hotei_battery_state
                name: State
              - entity: sensor.hotei_next_alarm
                name: Next Alarm
              - entity: sensor.hotei_wi_fi_connection
                name: WiFi
          - type: entities
            title: Zones
            show_header_toggle: false
            entities:
              - entity: zone.home
                name: Home
              - entity: zone.school
                name: School
              - entity: zone.work
                name: Work
      - type: grid
        cards:
          - type: entities
            title: Weather Automations
            show_header_toggle: false
            entities:
              - entity: automation.morning_weather_briefing
                name: Morning Briefing
              - entity: automation.extreme_weather_alert
                name: Weather Alerts
              - entity: automation.rain_reminder_when_leaving
                name: Rain Reminder
          - type: entities
            title: Backup
            show_header_toggle: false
            entities:
              - entity: sensor.backup_backup_manager_state
                name: Status
              - entity: sensor.backup_last_successful_automatic_backup
                name: Last Backup
              - entity: sensor.backup_next_scheduled_automatic_backup
                name: Next Backup
      - type: grid
        cards:
          - type: entities
            title: Car Automations
            show_header_toggle: false
            entities:
              - entity: automation.smart_id_3_climate_for_school_days
                name: Smart Climate
              - entity: automation.fallback_id_3_climate_mon_thu_07_00
                name: Fallback Climate
              - entity: automation.id_3_security_alert_doors_windows_open
                name: Security Alert
              - entity: automation.id_3_low_battery_warning
                name: Low Battery
              - entity: automation.remind_to_plug_in_id_3
                name: Plug-in Reminder
              - entity: automation.id_3_charging_complete
                name: Charging Complete
